{"filter":false,"title":"stop.js","tooltip":"/javascript/stop.js","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"insert","lines":["",""],"id":1},{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":2,"column":0},"end":{"row":80,"column":99},"action":"insert","lines":[" \"use strict\";"," ","window.addEventListener( \"DOMContentLoaded\" , ()=> {","    /**","     * @param watchCallBack 経過時間報告用コールバック","     * @param wrapCallBack ラップ報告用コールバック","     */","    const getStopWatch = function ( watchCallBack , wrapCallBack ){","        let accumulatedTime = 0,    // 積算時間","            currentTime=null,       // タイマー開示タイムスタンプ","            timerId=null;           // setInterval() の返り値"," ","            // リセット処理","        const reset = () =>{","            timerOff(); accumulatedTime = 0; currentTime=null;","                // リセットされたことをnullで通知","            watchCallBack( null ); wrapCallBack ( null );","        };","            // 開始処理","        const start = () =>{ currentTime = Date.now();timerOn(); };","            // 一時停止処理","        const pause = () =>{","                // これまでの経過時間を退避","            accumulatedTime = getNowTime();","            timerOff();","            currentTime = null;","        };","            // 再開処理","        const resume = () =>start();","            // ラップ報告処理","        const wrap = () =>wrapCallBack( getNowTime() );","            // 経過時間の算出","        const getNowTime = () =>accumulatedTime + Date.now() - currentTime;"," ","            // タイマー停止処理","        const timerOff = () => {","            if( timerId === null ) return;","            clearInterval(timerId);","            timerId = null;","        };","            // タイマー開始処理","        const timerOn = () => {","            if( timerId !== null ) clearTimeout(timerId);","            timerId = setInterval(()=>watchCallBack( getNowTime() ),10);","        };"," ","        reset();"," ","            // 必要な機能だけ返す","        return Object.freeze({","            start:()=> currentTime === null && accumulatedTime === 0 ?   start()  : reset(),","            pause:()=> currentTime === null ? ( accumulatedTime === 0 ? false : resume() ) : pause(),","            wrap:()=> currentTime === null ?  false : wrap(),","        });","    };"," ","        // ミリ秒を画面表示する形式に変換","    const timeString = time =>`${","        Math.floor(time / 60000).toString().padStart(2,\"00\")","    }:${","        Math.floor(time % 60000 / 1000).toString().padStart(2,\"00\")","    }.${","        Math.floor(time % 1000).toString().padStart(3,\"000\").slice(0,2)","    }`;"," ","    const watchArea = document.getElementById(\"watchArea\");","    const wrapArea = document.getElementById(\"wrapArea\");"," ","    const stopWatchObj = getStopWatch(","         time => watchArea.textContent = time === null ? \"00:00.00\" : timeString( time ) ,","         time => wrapArea.value = time === null ? \"\" : wrapArea.value + \"\\n\" + timeString( time )","    );"," ","    const buttonDefine = [","            { id:\"start\" , listener:()=>stopWatchObj.start() },","            { id:\"pause\" , listener:()=>stopWatchObj.pause() },","            { id:\"wrap\"  , listener:()=>stopWatchObj.wrap()  }","        ];","    buttonDefine.forEach( e => document.getElementById(e.id).addEventListener(\"click\",e.listener));"],"id":2}],[{"start":{"row":80,"column":99},"end":{"row":81,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":81,"column":0},"end":{"row":81,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":81,"column":4},"end":{"row":82,"column":1},"action":"insert","lines":["});"," "],"id":4},{"start":{"row":81,"column":0},"end":{"row":81,"column":4},"action":"remove","lines":["    "]}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":5},{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":0,"column":14},"end":{"row":1,"column":1},"action":"remove","lines":[""," "],"id":6}]]},"ace":{"folds":[],"scrolltop":600,"scrollleft":0,"selection":{"start":{"row":6,"column":9},"end":{"row":6,"column":9},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":39,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1641916349060,"hash":"67f2f1f1c76d1e4d63c360c0115a3daf67020afc"}